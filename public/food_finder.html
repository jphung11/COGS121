
<!DOCTYPE html>

<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="styling.css">

    <script src="https://www.gstatic.com/firebasejs/3.9.0/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyAfCoC-kndsmuPJQs-OMjEFaIrQqWNeptg",
        authDomain: "foody-cogs121-1492804395262.firebaseapp.com",
        databaseURL: "https://foody-cogs121-1492804395262.firebaseio.com",
        projectId: "foody-cogs121-1492804395262",
        storageBucket: "foody-cogs121-1492804395262.appspot.com",
        messagingSenderId: "701518273477"
      };
      firebase.initializeApp(config);
    </script>
    <script>
        var RestCnt = 0;
        var MenuCnt = 0;
        var restaurants = firebase.database().ref('Restaurants').once('value').then(function(snapshot) {
            var CurrRestaurants = snapshot.val();
            var i;
            var j;
//            for (i = 0; i < CurrRestaurants.length; i++) {
//                console.log("Restaruant: " + CurrRestaurants[i].Name);
//                for (j = 0; j < CurrRestaurants[i].Menu.length; j++) {
//                    console.log("Dish's Name: " + CurrRestaurants[i].Menu[j].Name);
//                }
//            }
            
//            $(document).ready(function(){
//                document.getElementById("foodPic").src=CurrRestaurants[RestCnt].Menu[MenuCnt].Picture;
//                document.getElementById("foodPic").alt=CurrRestaurants[RestCnt].Menu[MenuCnt].Name;
//                document.getElementById("foodName").innerHTML=CurrRestaurants[RestCnt].Menu[MenuCnt].Name;
//            });
                document.getElementById("foodPic").src=CurrRestaurants[RestCnt].Menu[MenuCnt].Picture;
                document.getElementById("foodPic").alt=CurrRestaurants[RestCnt].Menu[MenuCnt].Name;
                document.getElementById("foodName").innerHTML=CurrRestaurants[RestCnt].Menu[MenuCnt].Name;
                document.getElementById("restName").innerHTML=CurrRestaurants[RestCnt].Name;
            
                var k;
                for (k = 0; k < parseInt(CurrRestaurants[RestCnt].Menu[MenuCnt].Rating); k++) {
                    var spanfilled = document.createElement("span");
                    var elem1 = document.createElement("img");
                    elem1.src = "../images/starfilled.png";
                    elem1.setAttribute("class", "img-responsive");
                    spanfilled.appendChild(elem1);
                    
                    document.getElementById("stars").appendChild(spanfilled);
                }

                for (; k < 5; k++) {
                    var spanempty = document.createElement("span");
                    var elem2 = document.createElement("img");
                    elem2.src = "../images/starempty.png";
                    elem2.setAttribute("class", "img-responsive");
                    spanempty.appendChild(elem2);
                    
                    document.getElementById("stars").appendChild(spanempty);
                }
            
            
            
                MenuCnt++;
//                if(MenuCnt >= CurrRestaurants[RestCnt].Menu.length) {
//                    RestCnt++;
//                    MenuCnt = 0;
//                }
            
        });
        
        
        function change() {
            firebase.database().ref('Restaurants').once('value').then(function(snapshot) {
                var CurrRestaurants = snapshot.val();
                if(MenuCnt >= CurrRestaurants[RestCnt].Menu.length) {
                    RestCnt++;
                    MenuCnt = 0;
//                    console.log("RestCnt: "+ RestCnt);
                    if (RestCnt >= CurrRestaurants.length) {
                        document.getElementById("foodPic").src="../images/nomore.png"
                        document.getElementById("foodPic").alt="No more";
                        document.getElementById("foodName").innerHTML="Currently no more dishes! :(";
                        document.getElementById("restName").innerHTML="";
                        document.getElementById("stars").innerHTML="";
                        return;
                    }
                }
                
                document.getElementById("foodPic").src=CurrRestaurants[RestCnt].Menu[MenuCnt].Picture;
                document.getElementById("foodPic").alt=CurrRestaurants[RestCnt].Menu[MenuCnt].Name;
                document.getElementById("foodName").innerHTML=CurrRestaurants[RestCnt].Menu[MenuCnt].Name;
                document.getElementById("restName").innerHTML=CurrRestaurants[RestCnt].Name;
                
                document.getElementById("stars").innerHTML="";
                var k;
                for (k = 0; k < parseInt(CurrRestaurants[RestCnt].Menu[MenuCnt].Rating); k++) {
                    var spanfilled = document.createElement("span");
                    var elem1 = document.createElement("img");
                    elem1.src = "../images/starfilled.png";
                    elem1.setAttribute("class", "img-responsive");
                    spanfilled.appendChild(elem1);
                    
                    document.getElementById("stars").appendChild(spanfilled);
                }

                for (; k < 5; k++) {
                    var spanempty = document.createElement("span");
                    var elem2 = document.createElement("img");
                    elem2.src = "../images/starempty.png";
                    elem2.setAttribute("class", "img-responsive");
                    spanempty.appendChild(elem2);
                    
                    document.getElementById("stars").appendChild(spanempty);
                }
                
                MenuCnt++;
//                console.log("CurrRestaurants: " + CurrRestaurants.length);
//                console.log("MenuCnt: " + MenuCnt);
            });
        }
    </script>
</head>
<body>
    <ul class="nav nav-pills" style="margin-bottom: 1%;">
      <li role="presentation" ><a href="./index.html">My favorites</a></li>
      <li role="presentation" class="active"><a href="./food_finder.html">Food finder</a></li>
      <li role="presentation"><a href="./business_submission.html">Business</a></li>

    </ul>

    <div class="card" style="width: 90%; text-align: center; ">
        <div class="card-block">
            <img id="foodPic" class="cardPic img-responsive" alt="Food Picture">
            <h4 class="card-title" id="foodName"></h4>
            <p class="card-text" id="restName"></p>
<!--
            <img id="foodPic" class="cardPic img-responsive" src="../images/hamburger_medium.jpg" alt="Hamburger">
            <h4 class="card-title" id="foodName">Hamburger</h4>
-->
            
<!--
            <div class="rating">
                <span>☆</span><span>☆</span><span>☆</span><span>☆</span><span>☆</span>
            </div>
-->
            
            <div class="rating" id="stars">
            </div>
            
  	        <button type="button" class="btn btn-danger" onclick="change()">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
            </button>
            <button type="button" class="btn btn-success" onclick="change()">
                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
            </button>

        </div>
    </div>
    
    <!-- bootstrap scripts -->
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
</body>
</html>
